From 64ce68980511e35747fa6321d57228d8a333fc48 Mon Sep 17 00:00:00 2001
From: Oden <hello@odensc.com>
Date: Thu, 13 Nov 2025 10:10:55 -0800
Subject: [PATCH] Drupal 11.2.8 - Issue #3522087: Pass attributes from
 responsive_image_formatter to responsive_image element

---
 core/modules/responsive_image/responsive_image.module          | 3 +++
 .../modules/responsive_image/src/Hook/ResponsiveImageHooks.php | 1 +
 2 files changed, 4 insertions(+)

diff --git a/core/modules/responsive_image/responsive_image.module b/core/modules/responsive_image/responsive_image.module
index 9fe3dc72b50..7bdeddff413 100644
--- a/core/modules/responsive_image/responsive_image.module
+++ b/core/modules/responsive_image/responsive_image.module
@@ -58,6 +58,9 @@ function template_preprocess_responsive_image_formatter(&$variables): void {
     $variables['responsive_image']['#uri'] = $item->uri;
   }
 
+  // Override any attributes with those set in the render array.
+  $attributes = array_merge($attributes, $variables['attributes']);
+
   foreach (['width', 'height'] as $key) {
     $variables['responsive_image']["#$key"] = $item->$key;
   }
diff --git a/core/modules/responsive_image/src/Hook/ResponsiveImageHooks.php b/core/modules/responsive_image/src/Hook/ResponsiveImageHooks.php
index 96d60bbe7f4..0f3ed72f75e 100644
--- a/core/modules/responsive_image/src/Hook/ResponsiveImageHooks.php
+++ b/core/modules/responsive_image/src/Hook/ResponsiveImageHooks.php
@@ -88,6 +88,7 @@ public function theme() : array {
       ],
       'responsive_image_formatter' => [
         'variables' => [
+          'attributes' => [],
           'item' => NULL,
           'item_attributes' => NULL,
           'url' => NULL,
-- 
2.34.1

